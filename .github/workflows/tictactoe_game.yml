name: Tic-Tac-Toe Game Update

on:
  workflow_dispatch: # –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é –∏ –ø–æ —Å—Å—ã–ª–∫–∞–º
    inputs:
      action:
        description: 'Game action (move or reset)'
        required: true
        default: 'reset'
      row:
        description: 'Row for move (0-2)'
        required: false
      col:
        description: 'Column for move (0-2)'
        required: false
  # –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å schedule –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –µ—Å–ª–∏ –∏–≥—Ä–∞ "–ø–æ—Ä—Ç–∏—Ç—Å—è" —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
  # schedule:
  #  - cron: '0 * * * *' # –ö–∞–∂–¥—ã–π —á–∞—Å, –Ω–∞–ø—Ä–∏–º–µ—Ä

jobs:
  update_game:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.x'

      - name: Run game logic
        run: |
          CMD_ARGS="--action ${{ github.event.inputs.action }}"
          if [ "${{ github.event.inputs.action }}" = "move" ]; then
            # –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ row –∏ col –ø–µ—Ä–µ–¥–∞–Ω—ã –∏ –Ω–µ –ø—É—Å—Ç—ã–µ, –µ—Å–ª–∏ action=move
            if [ -n "${{ github.event.inputs.row }}" ] && [ -n "${{ github.event.inputs.col }}" ]; then
              CMD_ARGS="$CMD_ARGS --row ${{ github.event.inputs.row }} --col ${{ github.event.inputs.col }}"
            else
              echo "::error::Action is 'move' but row or col is missing/empty."
              exit 1 # –ó–∞–≤–µ—Ä—à–∞–µ–º —Å –æ—à–∏–±–∫–æ–π, –µ—Å–ª–∏ –¥–ª—è move –Ω–µ—Ç row/col
            fi
          fi
          python game.py $CMD_ARGS

      - name: Commit and push changes
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'
          git add README.md board.json
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º
          if git diff --staged --quiet; then
            echo "No changes to commit."
          else
            git commit -m "üéÆ Tic-Tac-Toe: Update game state (Action: ${{ github.event.inputs.action }})"
            git push
          fi
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}